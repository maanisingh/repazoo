import{c as Q,b as W,v as U,r as n,t as P,j as e,B as o}from"./index-H4DaqSpq.js";import{u as G}from"./useQuery-Rv5Od9FD.js";import{u as J}from"./useMutation-wEDAY8qW.js";import{C as p,a as f,b as j,c as y,d as g}from"./card-C0ZjAVn9.js";import{I as E}from"./input-C4hLB7y9.js";import{L as l}from"./label-bb9_ZhkL.js";import{S as T,a as z,b as B,c as I,d as r}from"./select-CVlxWidq.js";import{T as X}from"./textarea-Dj6J8-S0.js";import{S as Y}from"./switch-Dk8qGgw1.js";import{B as K}from"./badge-pi7sX806.js";import{H as Z,T as ee,P as se}from"./theme-switch-C5tdu85W.js";import{M as ae}from"./main-D5uzAE8u.js";import{S as te,C as ne}from"./search-DeIJKnzn.js";import{T as re}from"./trending-up-B0C1Zg_d.js";import{L}from"./loader-circle-5YA-BuFT.js";import{C as ie}from"./calendar-2-3ddAiR.js";import{P as oe}from"./plus-BTQnvhC1.js";import{X as le}from"./index-EzDm0lmA.js";import{B as ce}from"./brain-B-WEZoDN.js";import"./index-DOV0-nUu.js";import"./index-BdQq_4o_.js";import"./index-D1IO__54.js";import"./index-BVj6NEvJ.js";import"./index-DG8OgmhZ.js";import"./index-CZMQeqyZ.js";import"./index-CQiHdsHp.js";import"./index-hI_Qe1FL.js";import"./index-BTLX_OZX.js";import"./index-D8QmCQ3_.js";import"./index-DAIdUsKU.js";import"./chevron-down-gc8dYoSV.js";import"./check-s5UCxJch.js";import"./chevron-up-B8exOOsA.js";import"./separator-DONs4C7t.js";import"./sign-out-dialog-hk5uccCc.js";import"./index-DIPJ9e2F.js";import"./index-DTAvTyP8.js";import"./chevron-right-BARXRStm.js";import"./index-D0zLoMui.js";import"./search-provider-BrsfzY6n.js";import"./command-D6Zdrqg1.js";import"./dialog-BUsDf1C4.js";import"./scroll-area-B7G2E8-s.js";import"./shield-alert-DNCMqb7A.js";import"./circle-check-BLnpqHR7.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],me=Q("save",de);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],he=Q("zap",ue);function xe(){const{auth:N}=W(),c=N.user?.accountNo||"",D=U(),[t,d]=n.useState([]),[m,C]=n.useState(""),[u,S]=n.useState("manual"),[i,b]=n.useState("llama3:8b"),[_,k]=n.useState(""),[w,F]=n.useState(!0),[q,A]=n.useState(""),{data:a,isLoading:V}=G({queryKey:["workflow-config",c],queryFn:async()=>{const s=await fetch(`/api/workflows/config?user_id=${c}`);if(!s.ok){if(s.status===404)return{scan_frequency:"manual",keywords:[],model_preference:"llama3:8b",notification_enabled:!0,max_scans_per_month:10,scans_used:0};throw new Error("Failed to fetch workflow configuration")}return s.json()},enabled:!!c});n.useState(()=>{a&&(d(a.keywords||[]),S(a.scan_frequency||"manual"),b(a.model_preference||"llama3:8b"),k(a.custom_analysis_prompt||""),F(a.notification_enabled!==!1),A(a.notification_email||N.user?.email||""))});const v=J({mutationFn:async s=>{const x=await fetch("/api/workflows/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:c,...s})});if(!x.ok)throw new Error("Failed to save configuration");return x.json()},onSuccess:()=>{P.success("Configuration saved successfully!"),D.invalidateQueries({queryKey:["workflow-config"]})},onError:s=>{P.error(s instanceof Error?s.message:"Failed to save configuration")}}),M=()=>{m.trim()&&!t.includes(m.trim())&&(d([...t,m.trim()]),C(""))},$=s=>{d(t.filter(x=>x!==s))},H=()=>{v.mutate({scan_frequency:u,keywords:t,custom_analysis_prompt:_,model_preference:i,notification_enabled:w,notification_email:q})},R=()=>"Free",h=()=>a?a.scans_used/a.max_scans_per_month*100:0,O=()=>{const s=h();return s>=90?"text-red-500":s>=70?"text-orange-500":"text-green-500"};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(te,{}),e.jsx(ee,{}),e.jsx(ne,{}),e.jsx(se,{})]})}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Workflow Configuration"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure how your reputation scans are performed and scheduled"})]}),e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Scan Quota"]}),e.jsx(y,{children:"Your current plan and usage"})]}),e.jsxs(K,{variant:"outline",className:"text-lg",children:[R()," Tier"]})]})}),e.jsx(g,{children:V?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(L,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Scans This Month"}),e.jsxs("span",{className:`text-2xl font-bold ${O()}`,children:[a?.scans_used||0," / ",a?.max_scans_per_month||10]})]}),e.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${h()>=90?"bg-red-500":h()>=70?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(h(),100)}%`}})}),a?.quota_reset_date&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Quota resets on ",new Date(a.quota_reset_date).toLocaleDateString()]}),e.jsx(o,{variant:"outline",size:"sm",className:"w-full",children:"Upgrade Plan for More Scans"})]})})]}),e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Scan Schedule"]}),e.jsx(y,{children:"Configure automatic scan frequency"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"scan-frequency",children:"Scan Frequency"}),e.jsxs(T,{value:u,onValueChange:S,children:[e.jsx(z,{id:"scan-frequency",children:e.jsx(B,{placeholder:"Select frequency"})}),e.jsxs(I,{children:[e.jsx(r,{value:"manual",children:"Manual Only"}),e.jsx(r,{value:"daily",children:"Daily"}),e.jsx(r,{value:"weekly",children:"Weekly"}),e.jsx(r,{value:"monthly",children:"Monthly"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u==="manual"?"Scans will only run when you manually trigger them":`Scans will run automatically ${u}`})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{htmlFor:"notifications",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive alerts when scans complete"})]}),e.jsx(Y,{id:"notifications",checked:w,onCheckedChange:F})]}),w&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"notification-email",children:"Notification Email"}),e.jsx(E,{id:"notification-email",type:"email",placeholder:"your.email@example.com",value:q,onChange:s=>A(s.target.value)})]})]})]}),e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"Keywords & Focus Areas"]}),e.jsx(y,{children:"Specify keywords or topics to focus on during analysis"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{placeholder:'Add keyword (e.g., "immigration", "hiring")',value:m,onChange:s=>C(s.target.value),onKeyPress:s=>s.key==="Enter"&&M()}),e.jsx(o,{onClick:M,size:"icon",children:e.jsx(oe,{className:"h-4 w-4"})})]}),t.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(s=>e.jsxs(K,{variant:"secondary",className:"px-3 py-1",children:[s,e.jsx("button",{onClick:()=>$(s),className:"ml-2 hover:text-destructive",children:e.jsx(le,{className:"h-3 w-3"})})]},s))}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No keywords added yet. Add keywords to customize your analysis focus."}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Quick Add - Common Keywords:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["politics","religion","discrimination","violence","drugs","controversial"].map(s=>e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{t.includes(s)||d([...t,s])},disabled:t.includes(s),children:s},s))})]})]})]}),e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"AI Analysis Customization"]}),e.jsx(y,{children:"Customize how AI analyzes your Twitter content"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"model-preference",children:"AI Model"}),e.jsxs(T,{value:i,onValueChange:b,children:[e.jsx(z,{id:"model-preference",children:e.jsx(B,{placeholder:"Select AI model"})}),e.jsxs(I,{children:[e.jsx(r,{value:"llama3:8b",children:"Llama 3 (8B) - Fast & Accurate"}),e.jsx(r,{value:"mistral:7b",children:"Mistral (7B) - Balanced"}),e.jsx(r,{value:"llava:13b",children:"LLaVA (13B) - Vision-Enhanced"})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[i==="llama3:8b"&&"Recommended for general analysis",i==="mistral:7b"&&"Good balance of speed and quality",i==="llava:13b"&&"Best for tweets with images"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"custom-prompt",children:"Custom Analysis Instructions (Optional)"}),e.jsx(X,{id:"custom-prompt",placeholder:'e.g., "Focus on professional conduct and avoid political content..." (leave empty for default analysis)',value:_,onChange:s=>k(s.target.value),rows:4,className:"resize-none"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Provide specific instructions for AI to follow during analysis"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>window.location.reload(),children:"Reset Changes"}),e.jsx(o,{onClick:H,disabled:v.isPending,children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Save Configuration"]})})]})]})})]})}const is=xe;export{is as component};
