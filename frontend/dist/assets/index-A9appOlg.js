import{c as M,j as e,B as j,L as w,r as n}from"./index-pMfcpnTf.js";import{u as L}from"./useQuery-B_DiZ_WZ.js";import{S as T,C as V}from"./search-DwLeA47T.js";import{H as P,T as H,P as D}from"./theme-switch-C4S-6HCZ.js";import{M as I}from"./main-Cw_qbN6S.js";import{n8nClient as q}from"./repazoo-client-DWf3vMtU.js";import{D as c,u as B,g as K,c as A,d as E,i as G,e as U,h as z,a as O,f as u,b as Q}from"./toolbar-B9lYQ3J0.js";import{T as $,a as J,b as d,c as W,d as X,e as g}from"./table-Bld71e4i.js";import{B as x}from"./badge-DY8AObi8.js";import{C as p}from"./checkbox-CTHMxlPI.js";import{R as Y}from"./risk-gauge-Cl-egM9N.js";import{f as h}from"./format-Dp3w_Y3x.js";import{P as Z}from"./plus-K4egsVtH.js";import{L as ee}from"./loader-circle-Cbubtl-n.js";import"./index-DJGIFd9d.js";import"./index-CVLh5Qi8.js";import"./index-lmo_ryW-.js";import"./index-E5gx1TzI.js";import"./index-aR54NZgu.js";import"./index-BXiHxxjI.js";import"./index-CYsfw6C_.js";import"./index-BsvdxWD-.js";import"./index-BPInfwSf.js";import"./index-Bek2t7nc.js";import"./index-B5Y3zkbn.js";import"./search-provider-uR_ZSBSP.js";import"./command-BX3hK_ot.js";import"./index-Dr76E90w.js";import"./index-Db172Yu3.js";import"./dialog-CX5aGn-R.js";import"./scroll-area-B0lZMhXr.js";import"./index-BdQq_4o_.js";import"./sign-out-dialog-CvXe0n0W.js";import"./index-sMsvUuuL.js";import"./check-B79Npkn9.js";import"./chevron-right-BdpGBJQp.js";import"./shield-alert-ve4_Zsjm.js";import"./circle-check-BLHMQ0lS.js";import"./separator-DdNwgtgF.js";import"./react-icons.esm-DyxpfFtH.js";import"./select-IpOaZGF6.js";import"./chevron-down-x-qVSGyN.js";import"./chevron-up-DMnZttNJ.js";import"./input-CEzZO6nY.js";import"./popover-DhmK5g1D.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],se=M("external-link",te),ae=t=>{switch(t?.toLowerCase()){case"low":return"default";case"medium":return"secondary";case"high":return"destructive";default:return"outline"}},le=t=>{switch(t.toLowerCase()){case"completed":return"default";case"processing":return"secondary";case"failed":return"destructive";case"pending":return"outline";default:return"outline"}},f=[{id:"select",header:({table:t})=>e.jsx(p,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>t.toggleAllPageRowsSelected(!!s),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:t})=>e.jsx(p,{checked:t.getIsSelected(),onCheckedChange:s=>t.toggleSelected(!!s),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"twitter_handle",header:({column:t})=>e.jsx(c,{column:t,title:"Twitter Handle"}),cell:({row:t})=>e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"font-medium",children:["@",t.getValue("twitter_handle")]})})},{accessorKey:"status",header:({column:t})=>e.jsx(c,{column:t,title:"Status"}),cell:({row:t})=>{const s=t.getValue("status");return e.jsx(x,{variant:le(s),children:s})},filterFn:(t,s,a)=>a.includes(t.getValue(s))},{accessorKey:"summary.overall_score",id:"risk_score",header:({column:t})=>e.jsx(c,{column:t,title:"Risk Score"}),cell:({row:t})=>{const s=t.original,a=s.summary?.overall_score??s.analysis_result?.overall_score;return s.status!=="completed"||a===void 0?e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"}):e.jsx(Y,{score:a,size:"sm",showLabel:!1})},sortingFn:(t,s)=>{const a=t.original.summary?.overall_score??t.original.analysis_result?.overall_score??0,o=s.original.summary?.overall_score??s.original.analysis_result?.overall_score??0;return a-o}},{accessorKey:"summary.risk_level",id:"risk_level",header:({column:t})=>e.jsx(c,{column:t,title:"Risk Level"}),cell:({row:t})=>{const s=t.original,a=s.summary?.risk_level??s.analysis_result?.risk_level;return s.status!=="completed"||!a?e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"}):e.jsx(x,{variant:ae(a),children:a})},filterFn:(t,s,a)=>{const o=t.original.summary?.risk_level??t.original.analysis_result?.risk_level;return a.includes(o)}},{accessorKey:"created_at",header:({column:t})=>e.jsx(c,{column:t,title:"Scan Date"}),cell:({row:t})=>{const s=new Date(t.getValue("created_at"));return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:h(s,"MMM d, yyyy")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:h(s,"HH:mm")})]})}},{id:"actions",cell:({row:t})=>{const s=t.original;return e.jsx(j,{asChild:!0,variant:"ghost",size:"sm",children:e.jsxs(w,{to:"/scans/$scanId",params:{scanId:s.scan_id},children:["View ",e.jsx(se,{className:"ml-2 h-3 w-3"})]})})}}],re=[{label:"Completed",value:"completed"},{label:"Processing",value:"processing"},{label:"Failed",value:"failed"},{label:"Pending",value:"pending"}],oe=[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}];function ie({data:t}){const[s,a]=n.useState({}),[o,v]=n.useState([{id:"created_at",desc:!0}]),[y,S]=n.useState({}),[b,C]=n.useState(""),[_,k]=n.useState([]),i=B({data:t,columns:f,state:{sorting:o,columnVisibility:y,rowSelection:s,columnFilters:_,globalFilter:b},enableRowSelection:!0,onRowSelectionChange:a,onSortingChange:v,onColumnVisibilityChange:S,onGlobalFilterChange:C,onColumnFiltersChange:k,globalFilterFn:(r,l,N)=>{const R=String(r.getValue("twitter_handle")).toLowerCase(),F=String(r.getValue("status")).toLowerCase(),m=String(N).toLowerCase();return R.includes(m)||F.includes(m)},getCoreRowModel:z(),getFilteredRowModel:U(),getPaginationRowModel:G(),getSortedRowModel:E(),getFacetedRowModel:A(),getFacetedUniqueValues:K()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{table:i,searchPlaceholder:"Filter by Twitter handle...",filters:[{columnId:"status",title:"Status",options:re},{columnId:"risk_level",title:"Risk Level",options:oe}]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs($,{children:[e.jsx(J,{children:i.getHeaderGroups().map(r=>e.jsx(d,{children:r.headers.map(l=>e.jsx(W,{colSpan:l.colSpan,children:l.isPlaceholder?null:u(l.column.columnDef.header,l.getContext())},l.id))},r.id))}),e.jsx(X,{children:i.getRowModel().rows?.length?i.getRowModel().rows.map(r=>e.jsx(d,{"data-state":r.getIsSelected()&&"selected",children:r.getVisibleCells().map(l=>e.jsx(g,{children:u(l.column.columnDef.cell,l.getContext())},l.id))},r.id)):e.jsx(d,{children:e.jsx(g,{colSpan:f.length,className:"h-24 text-center",children:"No scans found."})})})]})}),e.jsx(Q,{table:i})]})}function Ze(){const{data:t,isLoading:s,isError:a,error:o}=L({queryKey:["scans"],queryFn:()=>q.getAllScans()});return e.jsxs(e.Fragment,{children:[e.jsxs(P,{fixed:!0,children:[e.jsx(T,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(H,{}),e.jsx(V,{}),e.jsx(D,{})]})]}),e.jsxs(I,{children:[e.jsxs("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Reputation Scans"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage all Twitter reputation scans"})]}),e.jsx(j,{asChild:!0,children:e.jsxs(w,{to:"/scans/new",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"New Scan"]})})]}),s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-destructive text-lg font-medium",children:"Failed to load scans"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:o instanceof Error?o.message:"Unknown error occurred"})]}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1",children:e.jsx(ie,{data:t?.scans??[]})})]})]})}export{Ze as component};
