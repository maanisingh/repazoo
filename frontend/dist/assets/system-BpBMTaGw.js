import{c as D,r as b,j as e,d as U,B as C,X as E}from"./index-H4DaqSpq.js";import{u as T}from"./useQuery-Rv5Od9FD.js";import{a as q}from"./admin-client-Dm-1oUCg.js";import{C as d,a as o,b as x,c as u,d as h}from"./card-C0ZjAVn9.js";import{B as c}from"./badge-pi7sX806.js";import{c as V}from"./index-DG8OgmhZ.js";import{P as $}from"./index-DOV0-nUu.js";import{L as Q}from"./loader-circle-5YA-BuFT.js";import{C as _}from"./circle-x-BdibaivK.js";import{R as P}from"./refresh-cw-CEViQTj1.js";import{A as g}from"./activity-B2uimjUx.js";import{D as z}from"./database-DDJJCPA0.js";import{T as F}from"./triangle-alert-D83IU5E5.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],X=D("cpu",H);var w="Progress",M=100,[G]=V(w),[O,K]=G(w),R=b.forwardRef((s,a)=>{const{__scopeProgress:l,value:n=null,max:r,getValueLabel:p=J,...y}=s;(r||r===0)&&!k(r)&&console.error(W(`${r}`,"Progress"));const i=k(r)?r:M;n!==null&&!S(n,i)&&console.error(Y(`${n}`,"Progress"));const t=S(n,i)?n:null,m=j(t)?p(t,i):void 0;return e.jsx(O,{scope:l,value:t,max:i,children:e.jsx($.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":j(t)?t:void 0,"aria-valuetext":m,role:"progressbar","data-state":L(t,i),"data-value":t??void 0,"data-max":i,...y,ref:a})})});R.displayName=w;var B="ProgressIndicator",I=b.forwardRef((s,a)=>{const{__scopeProgress:l,...n}=s,r=K(B,l);return e.jsx($.div,{"data-state":L(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...n,ref:a})});I.displayName=B;function J(s,a){return`${Math.round(s/a*100)}%`}function L(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function j(s){return typeof s=="number"}function k(s){return j(s)&&!isNaN(s)&&s>0}function S(s,a){return j(s)&&!isNaN(s)&&s<=a&&s>=0}function W(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${M}\`.`}function Y(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${M} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var A=R,Z=I;const v=b.forwardRef(({className:s,value:a,...l},n)=>e.jsx(A,{ref:n,className:U("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...l,children:e.jsx(Z,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));v.displayName=A.displayName;function ue(){const{data:s,isLoading:a,error:l,refetch:n}=T({queryKey:["admin","system-health"],queryFn:()=>q.getSystemHealth(),refetchInterval:1e4});if(a)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(l)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Failed to load system health"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:l instanceof Error?l.message:"Unknown error"}),e.jsxs(C,{onClick:()=>n(),className:"mt-4",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Retry"]})]});const r=t=>{switch(t){case"healthy":return"bg-green-500";case"degraded":return"bg-yellow-500";case"unhealthy":return"bg-red-500";default:return"bg-gray-500"}},p=t=>{switch(t){case"healthy":return e.jsx(E,{className:"h-5 w-5 text-green-500"});case"degraded":return e.jsx(F,{className:"h-5 w-5 text-yellow-500"});case"unhealthy":return e.jsx(_,{className:"h-5 w-5 text-red-500"});default:return e.jsx(g,{className:"h-5 w-5 text-gray-500"})}},y=t=>{const m=Math.floor(t/86400),N=Math.floor(t%86400/3600),f=Math.floor(t%3600/60);return`${m}d ${N}h ${f}m`},i=t=>{if(t===0)return"0 B";const m=1024,N=["B","KB","MB","GB","TB"],f=Math.floor(Math.log(t)/Math.log(m));return Math.round(t/Math.pow(m,f)*100)/100+" "+N[f]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"System Health"}),e.jsxs(C,{onClick:()=>n(),size:"sm",variant:"outline",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[p(s?.status||"healthy"),"System Status"]}),e.jsxs(u,{children:["Last updated: ",s?new Date(s.timestamp).toLocaleString():"-"]})]}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"outline",className:`${r(s?.status||"healthy")} text-white border-0 px-4 py-2 text-sm`,children:s?.status.toUpperCase()}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Uptime: ",s?y(s.uptime):"-"]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"Redis"]}),e.jsx(u,{children:"Cache and queue backend"})]}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status"}),s?.redis.connected?e.jsx(c,{variant:"default",className:"bg-green-500",children:"Connected"}):e.jsx(c,{variant:"destructive",children:"Disconnected"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Memory Used"}),e.jsx("span",{className:"text-sm font-medium",children:s?.redis.used_memory||"-"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Connected Clients"}),e.jsx("span",{className:"text-sm font-medium",children:s?.redis.connected_clients||0})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"PostgreSQL"]}),e.jsx(u,{children:"Primary database"})]}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status"}),s?.database.connected?e.jsx(c,{variant:"default",className:"bg-green-500",children:"Connected"}):e.jsx(c,{variant:"destructive",children:"Disconnected"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active Connections"}),e.jsx("span",{className:"text-sm font-medium",children:s?.database.active_connections||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Max Connections"}),e.jsx("span",{className:"text-sm font-medium",children:s?.database.max_connections||0})]}),s?.database.max_connections&&s?.database.active_connections&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Connection Usage"}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.database.active_connections/s.database.max_connections*100),"%"]})]}),e.jsx(v,{value:s.database.active_connections/s.database.max_connections*100})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"BullMQ Queues"]}),e.jsx(u,{children:"Job queue system"})]}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Queues"}),e.jsx("span",{className:"text-sm font-medium",children:s?.queues.total||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Healthy"}),e.jsx(c,{variant:"default",className:"bg-green-500",children:s?.queues.healthy||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Paused"}),e.jsx(c,{variant:"secondary",children:s?.queues.paused||0})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"System Resources"]}),e.jsx(u,{children:"Server hardware stats"})]}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Platform"}),e.jsx("span",{className:"text-sm font-medium capitalize",children:s?.system.platform||"-"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"CPU Cores"}),e.jsx("span",{className:"text-sm font-medium",children:s?.system.cpu_count||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Memory Usage"}),e.jsx("span",{className:"text-sm font-medium",children:s?i(s.system.memory_usage):"-"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Memory"}),e.jsx("span",{className:"text-sm font-medium",children:s?i(s.system.memory_total):"-"})]}),s?.system.memory_total&&s?.system.memory_usage&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Usage"}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.system.memory_usage/s.system.memory_total*100),"%"]})]}),e.jsx(v,{value:s.system.memory_usage/s.system.memory_total*100})]}),s?.system.load_average&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Load Average"}),e.jsx("span",{className:"text-sm font-medium",children:s.system.load_average.map(t=>t.toFixed(2)).join(", ")})]})]})]})]})]})}export{ue as component};
