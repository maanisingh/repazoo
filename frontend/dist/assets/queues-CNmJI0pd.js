import{c as L,af as R,r as p,t as f,j as e,n as A,B as m}from"./index-DJ90lmtz.js";import{u as y}from"./useQuery-0OtsgxzG.js";import{u as B}from"./useMutation-Uo1nsWOm.js";import{a as o}from"./admin-client-Dm-1oUCg.js";import{C as g,a as N,b as v,d as b,c as I}from"./card-C7fUoxAa.js";import{B as i}from"./badge-Bj0RyG7G.js";import{T as J,a as D,b as w,c as r,d as E,e as n}from"./table-B8g0Y7Uw.js";import{S as K,a as M,b as P,c as H,d as l}from"./select-CYJUntLO.js";import{L as C}from"./loader-circle-CCTG8lrF.js";import{R as x}from"./refresh-cw-DaYcZGvB.js";import"./index-BdQq_4o_.js";import"./index-BxVlSr3S.js";import"./index-BZ4b_QVw.js";import"./index-CHX5D7g7.js";import"./index-BmMetlW3.js";import"./index-Ca_DM27t.js";import"./index-Cl83K5VM.js";import"./index-BjXKqpud.js";import"./index-DQSaeAYD.js";import"./chevron-down-CCM2sUDQ.js";import"./check-CzAYJCFm.js";import"./chevron-up-DsKr4mWU.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],z=L("pause",V);function ue(){const u=R(),[t,S]=p.useState(null),[a,Q]=p.useState("waiting"),{data:T,isLoading:k,error:c,refetch:h}=y({queryKey:["admin","queues"],queryFn:()=>o.getQueueStats(),refetchInterval:5e3}),{data:d,isLoading:q}=y({queryKey:["admin","queue-jobs",t,a],queryFn:()=>t?o.getQueueJobs(t,a):null,enabled:!!t}),j=B({mutationFn:({queueName:s,jobId:F})=>o.retryFailedJob(s,F),onSuccess:()=>{f.success("Job has been added back to the queue"),u.invalidateQueries({queryKey:["admin","queue-jobs"]}),u.invalidateQueries({queryKey:["admin","queues"]})},onError:s=>{f.error(s.message)}});return k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(C,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(A,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Failed to load queue stats"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:c instanceof Error?c.message:"Unknown error"}),e.jsxs(m,{onClick:()=>h(),className:"mt-4",children:[e.jsx(x,{className:"mr-2 h-4 w-4"}),"Retry"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Queue Monitoring"}),e.jsxs(m,{onClick:()=>h(),size:"sm",variant:"outline",children:[e.jsx(x,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:T?.map(s=>e.jsxs(g,{className:`cursor-pointer transition-all hover:shadow-md ${t===s.name?"ring-2 ring-primary":""}`,onClick:()=>S(s.name),children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-sm font-medium flex items-center justify-between",children:[s.name,s.paused&&e.jsxs(i,{variant:"secondary",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Paused"]})]})}),e.jsxs(b,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Waiting"}),e.jsx(i,{variant:"outline",children:s.waiting})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Active"}),e.jsx(i,{variant:"secondary",children:s.active})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Completed"}),e.jsx(i,{variant:"default",className:"bg-green-500",children:s.completed})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Failed"}),e.jsx(i,{variant:"destructive",children:s.failed})]})]})]},s.name))}),t&&e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(v,{children:["Jobs: ",t]}),e.jsx(I,{children:"View and manage queue jobs"})]}),e.jsxs(K,{value:a,onValueChange:s=>Q(s),children:[e.jsx(M,{className:"w-[180px]",children:e.jsx(P,{})}),e.jsxs(H,{children:[e.jsx(l,{value:"waiting",children:"Waiting"}),e.jsx(l,{value:"active",children:"Active"}),e.jsx(l,{value:"completed",children:"Completed"}),e.jsx(l,{value:"failed",children:"Failed"}),e.jsx(l,{value:"delayed",children:"Delayed"})]})]})]})}),e.jsx(b,{children:q?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(C,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):d&&d.length>0?e.jsxs(J,{children:[e.jsx(D,{children:e.jsxs(w,{children:[e.jsx(r,{children:"Job ID"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Attempts"}),e.jsx(r,{children:"Timestamp"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(E,{children:d.map(s=>e.jsxs(w,{children:[e.jsx(n,{className:"font-mono text-xs",children:s.id}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.attemptsMade}),e.jsx(n,{children:new Date(s.timestamp).toLocaleString()}),e.jsx(n,{children:a==="failed"&&e.jsxs(m,{size:"sm",variant:"outline",onClick:()=>j.mutate({queueName:t,jobId:s.id}),disabled:j.isPending,children:[e.jsx(x,{className:"mr-1 h-3 w-3"}),"Retry"]})})]},s.id))})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:["No ",a," jobs found"]})})]})]})}export{ue as component};
