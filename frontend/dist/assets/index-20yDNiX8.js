import{c as B,b as H,r as l,t as i,j as e,B as o,X as W,n as $}from"./index-H4DaqSpq.js";import{u as T}from"./useQuery-Rv5Od9FD.js";import{u as S}from"./useMutation-wEDAY8qW.js";import{C as c,a as d,b as m,c as h,d as p}from"./card-C0ZjAVn9.js";import{T as G}from"./textarea-Dj6J8-S0.js";import{B as x}from"./badge-pi7sX806.js";import{Y as K,Z as Y,_ as Q,$ as V,a0 as X,a1 as Z,a2 as ee,a3 as se}from"./sign-out-dialog-hk5uccCc.js";import{H as te,T as ae,P as re}from"./theme-switch-C5tdu85W.js";import{M as ie}from"./main-D5uzAE8u.js";import{S as ne,C as oe}from"./search-DeIJKnzn.js";import{b as le}from"./search-provider-BrsfzY6n.js";import{S as _}from"./sparkles-q_SUDVdv.js";import{L as b}from"./loader-circle-5YA-BuFT.js";import{E as ce}from"./eye-CdBRBZ6q.js";import{S as de}from"./send-atS3ODdM.js";import{E as me}from"./external-link-Bg2vGJkm.js";import{T as he}from"./trash-2-DP13TDBf.js";import{T as pe}from"./trending-up-B0C1Zg_d.js";import"./index-EzDm0lmA.js";import"./index-D1IO__54.js";import"./index-DG8OgmhZ.js";import"./index-BTLX_OZX.js";import"./index-hI_Qe1FL.js";import"./index-CZMQeqyZ.js";import"./index-DOV0-nUu.js";import"./index-CQiHdsHp.js";import"./index-DIPJ9e2F.js";import"./index-DAIdUsKU.js";import"./index-BVj6NEvJ.js";import"./index-DTAvTyP8.js";import"./check-s5UCxJch.js";import"./chevron-right-BARXRStm.js";import"./separator-DONs4C7t.js";import"./index-D0zLoMui.js";import"./index-D8QmCQ3_.js";import"./circle-check-BLnpqHR7.js";import"./dialog-BUsDf1C4.js";import"./command-D6Zdrqg1.js";import"./scroll-area-B7G2E8-s.js";import"./index-BdQq_4o_.js";import"./shield-alert-DNCMqb7A.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],P=B("lightbulb",xe);function ue(){const{auth:z}=H(),n=z.user?.accountNo||"",[r,u]=l.useState(""),[v,k]=l.useState(!1),[t,g]=l.useState(null),[D,j]=l.useState(!1),{data:I,isLoading:E}=T({queryKey:["recommendations",n],queryFn:async()=>{const s=await fetch(`/api/mentions/recommendations?user_id=${n}`);return s.ok?s.json():{recommendations:[{id:"1",type:"positive",priority:"high",title:"Share Professional Achievement",description:"Post about recent professional accomplishments",suggestedPost:"Excited to share that I successfully completed [your achievement]. Grateful for the learning experience! #ProfessionalGrowth",reasoning:"Sharing achievements demonstrates growth and competence."},{id:"2",type:"engagement",priority:"high",title:"Engage with Industry Leaders",description:"Reply thoughtfully to posts in your industry",suggestedPost:"Great insights! I especially appreciate the point about [specific topic]. Thanks for sharing!",reasoning:"Engaging with respected voices creates positive associations."},{id:"3",type:"positive",priority:"medium",title:"Share Educational Content",description:"Post about something you learned",suggestedPost:"Just learned about [interesting topic]. Key takeaway: [your insight]. What has been your experience?",reasoning:"Educational content positions you as knowledgeable."}]}},enabled:!!n,staleTime:300*1e3}),{data:R,refetch:f}=T({queryKey:["recent-tweets",n],queryFn:async()=>{const s=await fetch(`/api/twitter/my-posts/${n}`);if(!s.ok)throw new Error("Failed to fetch recent tweets");return s.json()},enabled:!!n}),w=S({mutationFn:async s=>{const a=await fetch("/api/twitter/post-tweet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n,tweet_text:s})});if(!a.ok)throw new Error("Failed to post tweet");return a.json()},onSuccess:()=>{i.success("Tweet posted successfully!"),u(""),g(null),j(!1),f()},onError:s=>{i.error(s instanceof Error?s.message:"Failed to post tweet")}}),F=S({mutationFn:async s=>{const a=await fetch("/api/twitter/delete-tweet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n,tweet_id:s})});if(!a.ok)throw new Error("Failed to delete tweet");return a.json()},onSuccess:()=>{i.success("Tweet deleted successfully"),f()},onError:s=>{i.error(s instanceof Error?s.message:"Failed to delete tweet")}}),O=async()=>{if(!r.trim()){i.error("Please enter tweet text first");return}k(!0);try{const s=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama3:8b",prompt:`Analyze this tweet for reputation risk before posting. Rate it on a scale of 0-100 (100 being safest). Consider: professionalism, controversial topics, sentiment, potential misinterpretation.

Tweet: "${r}"

Respond with JSON:
{
  "risk_score": <number 0-100>,
  "risk_level": "<low/medium/high>",
  "concerns": [<array of strings>],
  "suggestions": [<array of strings>],
  "safe_to_post": <boolean>
}`,stream:!1})});if(!s.ok)throw new Error("Analysis failed");const A=(await s.json()).response.match(/\{[\s\S]*\}/);if(A){const N=JSON.parse(A[0]);g(N),N.risk_level==="high"?i.warning("High risk detected! Review concerns before posting."):N.risk_level==="low"?i.success("Analysis complete - Tweet looks good!"):i("Analysis complete - Review suggestions",{icon:"💡"})}}catch(s){i.error("Failed to analyze tweet"),console.error(s)}finally{k(!1)}},L=()=>{j(!0)},M=()=>{w.mutate(r)},U=s=>{u(s.suggestedPost),g(null)},J=s=>{switch(s){case"high":return e.jsx(pe,{className:"h-4 w-4 text-red-500"});case"medium":return e.jsx(P,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(_,{className:"h-4 w-4 text-blue-500"})}},y=s=>{switch(s){case"high":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"medium":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";default:return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}},q=I?.recommendations||[],C=R?.tweets?.slice(0,10)||[];return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(ne,{}),e.jsx(ae,{}),e.jsx(oe,{}),e.jsx(re,{})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"AI Chat & Tweet Composer"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Chat with AI, analyze tweets before posting, and manage your Twitter presence"})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"AI Chat Assistant"]}),e.jsx(h,{children:"Ask questions, get advice, or discuss your Twitter strategy with AI"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"w-full h-[600px] border rounded-lg overflow-hidden",children:e.jsx("iframe",{src:"https://ai.repazoo.com",className:"w-full h-full",title:"Open WebUI",sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Powered by Open WebUI and Ollama local AI models"})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Compose & Analyze Tweet"]}),e.jsx(h,{children:"Write your tweet and analyze it with AI before posting"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{placeholder:"What do you want to tweet?",value:r,onChange:s=>u(s.target.value),rows:5,maxLength:280,className:"resize-none"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:r.length>260?"text-orange-500":"text-muted-foreground",children:[r.length," / 280"]}),t&&e.jsxs(x,{className:y(t.risk_level),children:["Risk: ",t.risk_level.toUpperCase()," (",t.risk_score,"/100)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:O,disabled:!r.trim()||v,variant:"outline",className:"flex-1",children:v?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Analyze with AI"]})}),e.jsx(o,{onClick:L,disabled:!r.trim()||w.isPending,className:"flex-1",children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Posting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Post to Twitter"]})})]}),t&&e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[t.safe_to_post?e.jsx(W,{className:"h-5 w-5 text-green-500"}):e.jsx($,{className:"h-5 w-5 text-red-500"}),"Analysis Result"]}),e.jsx(x,{className:y(t.risk_level),children:t.risk_level.toUpperCase()})]}),t.concerns&&t.concerns.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400 mb-1",children:"Concerns:"}),e.jsx("ul",{className:"text-sm space-y-1",children:t.concerns.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500",children:"•"}),e.jsx("span",{children:s})]},a))})]}),t.suggestions&&t.suggestions.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mb-1",children:"Suggestions:"}),e.jsx("ul",{className:"text-sm space-y-1",children:t.suggestions.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500",children:"•"}),e.jsx("span",{children:s})]},a))})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex items-center gap-2 text-base",children:[e.jsx(P,{className:"h-5 w-5"}),"AI Recommendations"]}),e.jsx(h,{className:"text-xs",children:"Personalized suggestions to boost your reputation"})]}),e.jsx(p,{children:E?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(b,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"space-y-3",children:q.slice(0,3).map(s=>e.jsxs("div",{className:"border rounded-lg p-3 space-y-2 hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>U(s),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[J(s.priority),e.jsx("h4",{className:"text-sm font-semibold",children:s.title})]}),e.jsx(x,{variant:"outline",className:"text-xs",children:s.priority})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),e.jsx(o,{size:"sm",variant:"ghost",className:"w-full text-xs h-7",children:"Use This Suggestion"})]},s.id))})})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-base",children:"Recent Posts"}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>f(),children:"Refresh"})]}),e.jsx(h,{className:"text-xs",children:"Your last 10 tweets"})]}),e.jsx(p,{children:C.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No recent tweets found"}):e.jsx("div",{className:"space-y-3",children:C.map(s=>e.jsxs("div",{className:"border rounded-lg p-3 space-y-2",children:[e.jsx("p",{className:"text-sm line-clamp-3",children:s.text}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("div",{className:"flex items-center gap-3",children:s.public_metrics&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["❤️ ",s.public_metrics.like_count]}),e.jsxs("span",{children:["🔁 ",s.public_metrics.retweet_count]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"ghost",className:"flex-1 h-7 text-xs",asChild:!0,children:e.jsxs("a",{href:`https://twitter.com/user/status/${s.id}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"View"]})}),e.jsxs(o,{size:"sm",variant:"ghost",className:"flex-1 h-7 text-xs text-red-500",onClick:()=>{confirm("Delete this tweet?")&&F.mutate(s.id)},children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]},s.id))})})]})]})]})}),e.jsx(K,{open:D,onOpenChange:j,children:e.jsxs(Y,{children:[e.jsxs(Q,{children:[e.jsx(V,{children:"Post this tweet?"}),e.jsxs(X,{children:[t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"AI Risk Analysis:"}),e.jsxs(x,{className:y(t.risk_level),children:[t.risk_level.toUpperCase()," Risk - Score: ",t.risk_score,"/100"]}),!t.safe_to_post&&e.jsx("p",{className:"text-red-600 font-medium mt-2",children:"⚠️ AI recommends reviewing this tweet before posting"})]}):e.jsx("p",{children:"This tweet has not been analyzed. Consider analyzing it first for safety."}),e.jsx("div",{className:"mt-4 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm",children:r})})]})]}),e.jsxs(Z,{children:[e.jsx(ee,{children:"Cancel"}),e.jsx(se,{onClick:M,className:"bg-blue-500 hover:bg-blue-600",children:"Post to Twitter"})]})]})})]})}const as=ue;export{as as component};
