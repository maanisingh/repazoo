import{j as e,B as j,L as w,r as n}from"./index-H4DaqSpq.js";import{u as L}from"./useQuery-Rv5Od9FD.js";import{S as M,C as T}from"./search-DeIJKnzn.js";import{H as V,T as P,P as H}from"./theme-switch-C5tdu85W.js";import{M as D}from"./main-D5uzAE8u.js";import{n8nClient as I}from"./repazoo-client-hBgkOjH6.js";import{D as c,u as B,g as E,c as K,d as A,i as q,e as G,h as U,a as z,f as u,b as O}from"./toolbar-DI2aa2fi.js";import{T as Q,a as $,b as d,c as J,d as W,e as g}from"./table-CG2oaRXa.js";import{B as x}from"./badge-pi7sX806.js";import{C as p}from"./checkbox-UGBk40Hg.js";import{R as X}from"./risk-gauge-BJ8qHWpa.js";import{E as Y}from"./external-link-Bg2vGJkm.js";import{f as h}from"./format-Dp3w_Y3x.js";import{P as Z}from"./plus-BTQnvhC1.js";import{L as ee}from"./loader-circle-5YA-BuFT.js";import"./index-D0zLoMui.js";import"./index-D1IO__54.js";import"./index-DG8OgmhZ.js";import"./index-DOV0-nUu.js";import"./index-DTAvTyP8.js";import"./index-BVj6NEvJ.js";import"./index-BTLX_OZX.js";import"./index-CQiHdsHp.js";import"./index-hI_Qe1FL.js";import"./index-D8QmCQ3_.js";import"./index-DIPJ9e2F.js";import"./search-provider-BrsfzY6n.js";import"./command-D6Zdrqg1.js";import"./index-EzDm0lmA.js";import"./index-CZMQeqyZ.js";import"./dialog-BUsDf1C4.js";import"./scroll-area-B7G2E8-s.js";import"./index-BdQq_4o_.js";import"./sign-out-dialog-hk5uccCc.js";import"./index-DAIdUsKU.js";import"./check-s5UCxJch.js";import"./chevron-right-BARXRStm.js";import"./shield-alert-DNCMqb7A.js";import"./circle-check-BLnpqHR7.js";import"./separator-DONs4C7t.js";import"./react-icons.esm-CVjZIyiX.js";import"./select-CVlxWidq.js";import"./chevron-down-gc8dYoSV.js";import"./chevron-up-B8exOOsA.js";import"./input-C4hLB7y9.js";import"./popover-D3qpxQlH.js";const se=s=>{switch(s?.toLowerCase()){case"low":return"default";case"medium":return"secondary";case"high":return"destructive";default:return"outline"}},te=s=>{switch(s.toLowerCase()){case"completed":return"default";case"processing":return"secondary";case"failed":return"destructive";case"pending":return"outline";default:return"outline"}},f=[{id:"select",header:({table:s})=>e.jsx(p,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(p,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"twitter_handle",header:({column:s})=>e.jsx(c,{column:s,title:"Twitter Handle"}),cell:({row:s})=>e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"font-medium",children:["@",s.getValue("twitter_handle")]})})},{accessorKey:"status",header:({column:s})=>e.jsx(c,{column:s,title:"Status"}),cell:({row:s})=>{const t=s.getValue("status");return e.jsx(x,{variant:te(t),children:t})},filterFn:(s,t,a)=>a.includes(s.getValue(t))},{accessorKey:"summary.overall_score",id:"risk_score",header:({column:s})=>e.jsx(c,{column:s,title:"Risk Score"}),cell:({row:s})=>{const t=s.original,a=t.summary?.overall_score??t.analysis_result?.overall_score;return t.status!=="completed"||a===void 0?e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"}):e.jsx(X,{score:a,size:"sm",showLabel:!1})},sortingFn:(s,t)=>{const a=s.original.summary?.overall_score??s.original.analysis_result?.overall_score??0,o=t.original.summary?.overall_score??t.original.analysis_result?.overall_score??0;return a-o}},{accessorKey:"summary.risk_level",id:"risk_level",header:({column:s})=>e.jsx(c,{column:s,title:"Risk Level"}),cell:({row:s})=>{const t=s.original,a=t.summary?.risk_level??t.analysis_result?.risk_level;return t.status!=="completed"||!a?e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"}):e.jsx(x,{variant:se(a),children:a})},filterFn:(s,t,a)=>{const o=s.original.summary?.risk_level??s.original.analysis_result?.risk_level;return a.includes(o)}},{accessorKey:"created_at",header:({column:s})=>e.jsx(c,{column:s,title:"Scan Date"}),cell:({row:s})=>{const t=new Date(s.getValue("created_at"));return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:h(t,"MMM d, yyyy")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:h(t,"HH:mm")})]})}},{id:"actions",cell:({row:s})=>{const t=s.original;return e.jsx(j,{asChild:!0,variant:"ghost",size:"sm",children:e.jsxs(w,{to:"/scans/$scanId",params:{scanId:t.scan_id},children:["View ",e.jsx(Y,{className:"ml-2 h-3 w-3"})]})})}}],ae=[{label:"Completed",value:"completed"},{label:"Processing",value:"processing"},{label:"Failed",value:"failed"},{label:"Pending",value:"pending"}],re=[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}];function le({data:s}){const[t,a]=n.useState({}),[o,v]=n.useState([{id:"created_at",desc:!0}]),[S,y]=n.useState({}),[b,C]=n.useState(""),[R,_]=n.useState([]),i=B({data:s,columns:f,state:{sorting:o,columnVisibility:S,rowSelection:t,columnFilters:R,globalFilter:b},enableRowSelection:!0,onRowSelectionChange:a,onSortingChange:v,onColumnVisibilityChange:y,onGlobalFilterChange:C,onColumnFiltersChange:_,globalFilterFn:(l,r,N)=>{const k=String(l.getValue("twitter_handle")).toLowerCase(),F=String(l.getValue("status")).toLowerCase(),m=String(N).toLowerCase();return k.includes(m)||F.includes(m)},getCoreRowModel:U(),getFilteredRowModel:G(),getPaginationRowModel:q(),getSortedRowModel:A(),getFacetedRowModel:K(),getFacetedUniqueValues:E()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{table:i,searchPlaceholder:"Filter by Twitter handle...",filters:[{columnId:"status",title:"Status",options:ae},{columnId:"risk_level",title:"Risk Level",options:re}]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(Q,{children:[e.jsx($,{children:i.getHeaderGroups().map(l=>e.jsx(d,{children:l.headers.map(r=>e.jsx(J,{colSpan:r.colSpan,children:r.isPlaceholder?null:u(r.column.columnDef.header,r.getContext())},r.id))},l.id))}),e.jsx(W,{children:i.getRowModel().rows?.length?i.getRowModel().rows.map(l=>e.jsx(d,{"data-state":l.getIsSelected()&&"selected",children:l.getVisibleCells().map(r=>e.jsx(g,{children:u(r.column.columnDef.cell,r.getContext())},r.id))},l.id)):e.jsx(d,{children:e.jsx(g,{colSpan:f.length,className:"h-24 text-center",children:"No scans found."})})})]})}),e.jsx(O,{table:i})]})}function Ye(){const{data:s,isLoading:t,isError:a,error:o}=L({queryKey:["scans"],queryFn:()=>I.getAllScans()});return e.jsxs(e.Fragment,{children:[e.jsxs(V,{fixed:!0,children:[e.jsx(M,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(P,{}),e.jsx(T,{}),e.jsx(H,{})]})]}),e.jsxs(D,{children:[e.jsxs("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Reputation Scans"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage all Twitter reputation scans"})]}),e.jsx(j,{asChild:!0,children:e.jsxs(w,{to:"/scans/new",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"New Scan"]})})]}),t?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-destructive text-lg font-medium",children:"Failed to load scans"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:o instanceof Error?o.message:"Unknown error occurred"})]}):e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1",children:e.jsx(le,{data:s?.scans??[]})})]})]})}export{Ye as component};
